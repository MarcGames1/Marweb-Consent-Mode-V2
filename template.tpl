___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Marweb Consent Mode V2",
  "brand": {
    "id": "marweb.ro",
    "displayName": "Marweb.ro",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Consent Mode V2 GTM only",
  "containerContexts": [
    "WEB"
  ],
  "categories": ["TAG_MANAGEMENT", "MARKETING", "REMARKETING"	]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "PARAM_TABLE",
    "name": "defaultSettings",
    "displayName": "granted",
    "paramTableColumns": [
      {
        "param": {
          "type": "TEXT",
          "name": "granted",
          "displayName": "granted",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "denied",
          "displayName": "denied",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "region",
          "displayName": "region",
          "simpleValueType": true
        },
        "isUnique": false
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// The first two lines are optional, use if you want to enable logging
const log = require('logToConsole');
log('data =', data);
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const getCookieValues = require('getCookieValues');
const JSON = require('JSON');
const COOKIE_NAME = 'cookies_consent';

/*
 *   Splits the input string using comma as a delimiter, returning an array of
 *   strings
 */
const splitInput = (input) => {
  return input.split(',')
      .map(entry => entry.trim())
      .filter(entry => entry.length !== 0);
};

/*
 *   Processes a row of input from the default settings table, returning an object
 *   which can be passed as an argument to setDefaultConsentState
 */
const parseCommandData = (settings) => {
  const regions = splitInput(settings['region']);
  const granted = splitInput(settings['granted']);
  const denied = splitInput(settings['denied']);
  const commandData = {};
  if (regions.length > 0) {
    commandData.region = regions;
  }
  granted.forEach(entry => {
    commandData[entry] = 'granted';
  });
  denied.forEach(entry => {
    commandData[entry] = 'denied';
  });
  return commandData;
};

/*
 *   Called when consent changes. Assumes that consent object contains keys which
 *   directly correspond to Google consent types.
 */
const onUserConsent = (consent) => {  
  const cookieValues = consent[0];
  const cookieObj = JSON.parse(cookieValues);
  const consentModeStates = {
    ad_storage: cookieObj.ad_storage,
    ad_user_data: cookieObj.ad_user_data,
    ad_personalization: cookieObj.ad_personalization,
    analytics_storage: cookieObj.analytics_storage,
    functionality_storage: cookieObj.functionality_storage,
    personalization_storage: cookieObj.personalization_storage,
    security_storage: cookieObj.security_storage,
  };    
  updateConsentState(consentModeStates);
};

/*
 *   Executes the default command, sets the developer ID, and sets up the consent
 *   update callback
 */
const main = (data) => {
  // Set default consent state(s)
  data.defaultSettings.forEach(settings => {
    const defaultData = parseCommandData(settings);
  // wait_for_update (ms) allows for time to receive visitor choices from the CMP
    defaultData.wait_for_update = 500;
    setDefaultConsentState(defaultData);
  });

  // Check if cookie is set and has values that correspond to Google consent
  // types. If it does, run onUserConsent().
  const settings = getCookieValues(COOKIE_NAME);
  if (typeof settings !== 'undefined') {
    onUserConsent(settings);
  }  
};

main(data);
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "cookies_consent"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 20/05/2024, 15:09:11



